{% extends 'base_dashboard.html' %}
{% block dashboard_content %}
{% load static %}
{% load pwa %}
{% progressive_web_app_meta %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=1200, initial-scale=0.35">
    <meta name="theme-color" content="#0f172a">    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <style>
        /* 2. Lock the body width to Desktop dimensions */
        html, body { 
            width: 100%; 
            height: 100%; 
            margin: 0;
            min-width: 1200px; /* Forces Bootstrap to stay in 'xl' or 'xxl' mode */
            overflow-x: auto; 
            background-color: #f8f9fa;
        }

        .nav-link {
            white-space: nowrap;
            font-size: 1rem;
            color: #e2e8f0 !important;
            transition: all 0.3s ease;
        }
        
        .hover-lift:hover {
            background: linear-gradient(135deg, rgba(96, 165, 250, 0.15), rgba(167, 139, 250, 0.15));
            transform: translateY(-3px);
        }

        .active-link {
            background: linear-gradient(135deg, rgba(96, 165, 250, 0.25), rgba(167, 139, 250, 0.25)) !important;
            color: #ffffff !important;
        }
    </style>
</head>
<body>

    <div id="viewport-root" class="d-flex flex-column min-vh-100">
        <main class="flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center py-5">
            <h1 class="display-3 fw-bold mb-3 text-dark">Welcome to CShub!</h1>
            <p class="lead text-muted mb-5 fs-4">The premier community hub for CS students and developers.</p>

            {% if not user.is_authenticated %}
                <div class="mb-5">
                    <a href="{% url 'accounts:signup' %}" class="btn btn-primary btn-lg px-5 py-3 shadow">Get Started Now</a>
                </div>
            {% endif %}

            <div class="mt-4">
                <button id="pwa-install-btn" class="btn btn-dark btn-lg px-5 py-3 shadow-sm">
                    <i class="bi bi-download me-2"></i> Download CShub Desktop App
                </button>
                <p id="pwa-status" class="text-muted mt-3 small">
                    Check your browser's address bar or menu for the install icon.
                </p>
            </div>
        </main>
    </div>

    <script>
        // PWA Install Logic
        let deferredPrompt;
        const installBtn = document.getElementById('pwa-install-btn');

        window.addEventListener('beforeinstallprompt', (e) => {
            // This event only fires if the manifest.json and service worker are valid
            e.preventDefault();
            deferredPrompt = e;
            console.log('PWA: Ready to install');
        });

        installBtn.addEventListener('click', async () => {
            if (!deferredPrompt) {
                alert("To install, please use your browser's menu (â‹® or Share) and select 'Add to Home Screen'.");
                return;
            }
            deferredPrompt.prompt();
            const { outcome } = await deferredPrompt.userChoice;
            if (outcome === 'accepted') {
                installBtn.style.display = 'none';
            }
            deferredPrompt = null;
        });

        // If already in standalone mode, hide the button
        if (window.matchMedia('(display-mode: standalone)').matches) {
            installBtn.style.display = 'none';
            document.getElementById('pwa-status').innerText = "CShub is already installed!";
        }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
{% endblock %}